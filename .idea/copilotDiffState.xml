<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/gkhnakbs/weatherappwithwidget/domain/callbacks/RefreshWeatherActionCallback.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/gkhnakbs/weatherappwithwidget/domain/callbacks/RefreshWeatherActionCallback.kt" />
              <option name="originalContent" value="package com.gkhnakbs.weatherappwithwidget.domain.callbacks&#10;&#10;&#10;&#10;import android.content.Context&#10;import android.util.Log&#10;import androidx.glance.GlanceId&#10;import androidx.glance.action.ActionParameters&#10;import androidx.glance.appwidget.action.ActionCallback&#10;import androidx.glance.appwidget.state.updateAppWidgetState&#10;import com.gkhnakbs.weatherappwithwidget.domain.di.WeatherRepositoryEntryPoint&#10;import com.gkhnakbs.weatherappwithwidget.domain.state.WeatherWidgetState&#10;import com.gkhnakbs.weatherappwithwidget.domain.state.WeatherWidgetStateDefinition&#10;import com.gkhnakbs.weatherappwithwidget.presentation.ui.WeatherWidget&#10;import dagger.hilt.android.EntryPointAccessors&#10;import java.text.SimpleDateFormat&#10;import java.util.Date&#10;import java.util.Locale&#10;&#10;/**&#10; * Created by Gökhan Akbaş on 27/10/2025.&#10; */&#10;class RefreshWeatherActionCallback : ActionCallback {&#10;&#10;    override suspend fun onAction(&#10;        context: Context,&#10;        glanceId: GlanceId,&#10;        parameters: ActionParameters&#10;    ) {&#10;        // 1. Yükleniyor durumunu ayarla&#10;        updateAppWidgetState(context, WeatherWidgetStateDefinition, glanceId) { prefs -&gt;&#10;            prefs.toMutablePreferences().apply {&#10;                this[WeatherWidgetState.isLoading] = true&#10;            }&#10;        }&#10;        // Widget'ı &quot;Yükleniyor&quot; UI'ı için hemen güncelle&#10;        WeatherWidget().update(context, glanceId)&#10;&#10;        // 2. Hilt EntryPoint üzerinden Repository'ye eriş&#10;        val hiltEntryPoint = EntryPointAccessors.fromApplication(&#10;            context.applicationContext,&#10;            WeatherRepositoryEntryPoint::class.java&#10;        )&#10;        val repository = hiltEntryPoint.weatherRepository()&#10;&#10;        // 3. API'den veriyi çek&#10;        try {&#10;            // Ankara koordinatları&#10;            val data = repository.getWeatherData(38.643976, 34.734958)&#10;&#10;            // 4. Gelen veriyi widget state'ine kaydet&#10;            data?.let {&#10;                updateAppWidgetState(context, WeatherWidgetStateDefinition, glanceId) { prefs -&gt;&#10;                    prefs.toMutablePreferences().apply {&#10;                        this[WeatherWidgetState.isLoading] = false&#10;                        this[WeatherWidgetState.temperature] = &quot;${data.current?.temperature2m}${data.currentUnits?.temperature2m ?: &quot;°C&quot;}&quot;&#10;                        this[WeatherWidgetState.humidity] = &quot;${data.current?.relativeHumidity2m}${data.currentUnits?.relativeHumidity2m ?: &quot;%&quot;}&quot;&#10;                        this[WeatherWidgetState.location] = data.timezone?.split(&quot;/&quot;)?.lastOrNull() ?: &quot;Bilinmeyen&quot;&#10;                        this[WeatherWidgetState.lastUpdate] = &quot;Son Güncelleme: ${getCurrentTime()}&quot;&#10;                        this[WeatherWidgetState.apparentTemperature] =&#10;                            &quot;Hissedilen: ${data.current?.apparentTemperature}${data.currentUnits?.apparentTemperature ?: &quot;°C&quot;}&quot;&#10;                    }&#10;                }&#10;            }&#10;&#10;        } catch (e: Exception) {&#10;            // 5. Hata durumunda state'i güncelle&#10;            updateAppWidgetState(context, WeatherWidgetStateDefinition, glanceId) { prefs -&gt;&#10;                prefs.toMutablePreferences().apply {&#10;                    this[WeatherWidgetState.isLoading] = false&#10;                    this[WeatherWidgetState.temperature] = &quot;Hata!&quot;&#10;                    this[WeatherWidgetState.humidity] = &quot;Yeniden deneyin&quot;&#10;                    this[WeatherWidgetState.lastUpdate] = &quot;Son Güncelleme: ${getCurrentTime()}&quot;&#10;                    this[WeatherWidgetState.apparentTemperature] = &quot;&quot;&#10;                    this[WeatherWidgetState.location] = &quot;Bağlantı Hatası&quot;&#10;                }&#10;            }&#10;            Log.e(&quot;WeatherWidgetRefresh&quot;,&quot;Error: ${e.message}&quot;, e)&#10;        }&#10;        finally {&#10;            // 6. Widget UI'ını son veriyle güncelle&#10;            WeatherWidget().update(context, glanceId)&#10;        }&#10;    }&#10;&#10;    private fun getCurrentTime(): String {&#10;        return SimpleDateFormat(&quot;HH:mm&quot;, Locale.getDefault()).format(Date())&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.gkhnakbs.weatherappwithwidget.domain.callbacks&#10;&#10;&#10;&#10;import android.content.Context&#10;import android.util.Log&#10;import androidx.glance.GlanceId&#10;import androidx.glance.action.ActionParameters&#10;import androidx.glance.appwidget.action.ActionCallback&#10;import androidx.glance.appwidget.state.updateAppWidgetState&#10;import com.gkhnakbs.weatherappwithwidget.domain.di.WeatherRepositoryEntryPoint&#10;import com.gkhnakbs.weatherappwithwidget.domain.state.WeatherWidgetState&#10;import com.gkhnakbs.weatherappwithwidget.domain.state.WeatherWidgetStateDefinition&#10;import com.gkhnakbs.weatherappwithwidget.presentation.ui.WeatherWidget&#10;import dagger.hilt.android.EntryPointAccessors&#10;import java.text.SimpleDateFormat&#10;import java.util.Date&#10;import java.util.Locale&#10;&#10;/**&#10; * Created by Gökhan Akbaş on 27/10/2025.&#10; */&#10;class RefreshWeatherActionCallback : ActionCallback {&#10;&#10;    override suspend fun onAction(&#10;        context: Context,&#10;        glanceId: GlanceId,&#10;        parameters: ActionParameters&#10;    ) {&#10;        // 1. Yükleniyor durumunu ayarla&#10;        updateAppWidgetState(context, WeatherWidgetStateDefinition, glanceId) { prefs -&gt;&#10;            prefs.toMutablePreferences().apply {&#10;                this[WeatherWidgetState.isLoading] = true&#10;            }&#10;        }&#10;        // Widget'ı &quot;Yükleniyor&quot; UI'ı için hemen güncelle&#10;        WeatherWidget().update(context, glanceId)&#10;&#10;        // 2. Hilt EntryPoint üzerinden Repository'ye eriş&#10;        val hiltEntryPoint = EntryPointAccessors.fromApplication(&#10;            context.applicationContext,&#10;            WeatherRepositoryEntryPoint::class.java&#10;        )&#10;        val repository = hiltEntryPoint.weatherRepository()&#10;&#10;        // 3. API'den veriyi çek&#10;        try {&#10;            // Ankara koordinatları&#10;            val data = repository.getWeatherData(38.643976, 34.734958)&#10;&#10;            // 4. Gelen veriyi widget state'ine kaydet&#10;            data?.let {&#10;                updateAppWidgetState(context, WeatherWidgetStateDefinition, glanceId) { prefs -&gt;&#10;                    prefs.toMutablePreferences().apply {&#10;                        this[WeatherWidgetState.isLoading] = false&#10;                        this[WeatherWidgetState.temperature] = &quot;${data.current?.temperature2m}${data.currentUnits?.temperature2m ?: &quot;°C&quot;}&quot;&#10;                        this[WeatherWidgetState.humidity] = &quot;${data.current?.relativeHumidity2m}${data.currentUnits?.relativeHumidity2m ?: &quot;%&quot;}&quot;&#10;                        this[WeatherWidgetState.location] = data.timezone?.split(&quot;/&quot;)?.lastOrNull() ?: &quot;Bilinmeyen&quot;&#10;                        this[WeatherWidgetState.lastUpdate] = &quot;Son Güncelleme: ${getCurrentTime()}&quot;&#10;                        this[WeatherWidgetState.apparentTemperature] =&#10;                            &quot;Hissedilen: ${data.current?.apparentTemperature}${data.currentUnits?.apparentTemperature ?: &quot;°C&quot;}&quot;&#10;                    }&#10;                }&#10;            }&#10;&#10;        } catch (e: Exception) {&#10;            // 5. Hata durumunda state'i güncelle&#10;            updateAppWidgetState(context, WeatherWidgetStateDefinition, glanceId) { prefs -&gt;&#10;                prefs.toMutablePreferences().apply {&#10;                    this[WeatherWidgetState.isLoading] = false&#10;                    this[WeatherWidgetState.temperature] = &quot;Hata!&quot;&#10;                    this[WeatherWidgetState.humidity] = &quot;Yeniden deneyin&quot;&#10;                    this[WeatherWidgetState.lastUpdate] = &quot;Son Güncelleme: ${getCurrentTime()}&quot;&#10;                    this[WeatherWidgetState.apparentTemperature] = &quot;&quot;&#10;                    this[WeatherWidgetState.location] = &quot;Bağlantı Hatası&quot;&#10;                }&#10;            }&#10;            Log.e(&quot;WeatherWidgetRefresh&quot;,&quot;Error: ${e.message}&quot;, e)&#10;        }&#10;        finally {&#10;            // 6. Widget UI'ını son veriyle güncelle&#10;            WeatherWidget().update(context, glanceId)&#10;        }&#10;    }&#10;&#10;    private fun getCurrentTime(): String {&#10;        return SimpleDateFormat(&quot;HH:mm&quot;, Locale.getDefault()).format(Date())&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>